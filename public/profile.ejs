<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - TickTockTasks</title>
    <link rel="shortcut icon" href="Assests/img/title_logo.png" class="icon" sizes="192pxx192px">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" 
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="CSS/ckc.css">
    <script src="https://kit.fontawesome.com/10eadcceed.js" crossorigin="anonymous"></script>
    <script>
        // Prevent navigating back after logout
        function preventBack() {
          window.history.forward(); 
        }
        setTimeout("preventBack()", 0);
        window.onunload = function () { null };
    </script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
</head>
<body>
    <div class="row">
        <!-- SideNavBar -->
        <section class="sidebar d-none d-md-block min-vh-100 col-auto position-fixed">
            <a href="/home" class="logo">
                <img src="Assests/img/side_logo.svg" alt="" height="80%" width="80%">
            </a>
            <ul class="sidemenu">
                <li>
                    <a href="/home">
                        <i class="fa-solid fa-house"></i>
                        <span class="text">Home</span>
                    </a>
                </li>
                <li>
                    <a href="/task">
                        <i class="fa-solid fa-list"></i>
                        <span class="text">Task</span>
                    </a>
                </li>
                <li>
                    <a href="/calendar">
                        <i class="fa-solid fa-calendar-days"></i>
                        <span class="text">Calendar</span>
                    </a>
                </li>
                <li>
                    <a href="/profile" class="sidebar-active">
                        <i class="fa-solid fa-user"></i>
                        <span class="text">Profile</span>
                    </a>
                </li>
                <li>
                    <a href="/settings">
                        <i class="fa-solid fa-gear"></i>
                        <span class="text">Settings</span>
                    </a>
                </li>
                <li>
                    <a href="/about-us">
                        <i class="fa-solid fa-circle-exclamation"></i>
                        <span class="text">About Us</span>
                    </a>
                </li>
                <li>
                    <a href="/logout">
                        <i class="fa-solid fa-sign-out"></i> 
                        <span class="text">Log Out</span>
                    </a>
                </li>
            </ul>
        </section>
        <div class="bg-semidark d-md-none"></div>
        <!-- SideNavBar -->

        <section class = "main container-sm col">
            <main>
                <!-- Top -->
                <div class="top d-md-none ">
                    <a href="#" > 
                        <div class="toggle-nav-btn ">
                            <i class="fa-solid fa-bars fa-xl"></i>
                        </div>
                    </a>
                    <a href="/home">
                        <img src="Assests/img/top_logo.svg" alt="" height="80%" width="80%" class="logo-top">
                    </a>
                </div>
                <!-- Top -->

                
                <div class = "profile-container">
                    <% if(user.image.data != null ) {%>
                             <img src = "data:images/<%=user.image.contentType%>;base64,<%=user.image.data.toString('base64')%>" alt = "profile pic" id = "profile-pic">
                    <% }else{ %>
                            <img src = "./Assests/img/randomProfile.png" alt = "profile pic" id = "profile-pic">
                    <% } %>
                 <!-- <img src = "" alt = "profile pic" id = "profile-pic"> -->
                

                    <div class = "username-text-container d-flex flex-column bg">
                        <h2 id = "username">
                               <% if (user.username != null) { %>
                                        <%= user.username %>
                                <% } else { %>
                                        Username
                                <% } %></h5>
                        </h2>   
                        <h6 id = "joined"> Joined since June 2023. </h6>
        
                    </div>                 
                </div>
                <hr>   

                <div class = "form-container">

                    <div class="main-row row ">
                    <div class="profile-details col-xxl-7 col-xl-7 col-lg-7 col-md-12 col-sm-12"> 
                        <form action = "#" method = "POST" class = "detail-form">
                        <h4 class = "form-title"> Profile Details </h4>
                        <div class = "row">
                            <div >
                                <label for = "name" class="text-grey">Name<br> 
                                      <input type = "text" id = "name" name = "name" class="d-none" value="<%= user.username %>">
                                       <div class="name-empty-warning bg-danger text-white p-2 mt-0 rounded-3 d-none">Please Do Not Let It Empty</div>
                                </label>
                               
                              
                                <!-- <h5 class="fw-bold pt-1"><%= user.username %></h5> -->

                                <h4 class="fw-bold pt-1">          
                                <% if (user.username != null) { %>
                                        <%= user.username %>
                                <% } else { %>
                                        Username
                                <% } %></h4>
                            
            
                            </div>
                            <!-- <div class >
                                <label for = "lastname">Last Name<br> 
                                    <input type = "text" id = "lastname" name = "lastname">
                                </label>
                            </div> -->
                        </div>
                        <!-- <div class = "row">
                            <label for = "email">Email<br> 
                                <input type = "email" id = "email" name = "email">
                            </label>
                        </div>  -->
                        <div class = "row pt-2">
                            <label for = "phone-num" class="text-grey">Contact Number<br> 
                                <input type = "tel" id = "phone-num" name = "contact-num" class="d-none" value="<%= user.phone_num %>">
                                <div class="phone-empty-warning bg-danger text-white p-2 mt-0 rounded-3 d-none">Please Do Not Let It Empty</div>
                            </label>
                               
                             
                            <!-- <h5 class="fw-bold pt-1">011-23208087</h5> -->
                            <h4 class="fw-bold pt-1"><%= user.phone_num %></h4>
                        </div>
                        <div class = "row pt-2">
                            <div>
                                <label for = "dob" class="text-grey">Date of Birth<br> 
                                      <input type = "date" id = "dob" name = "dob" class="d-none" value= <% if (user.date_of_birth != null ) { %>
                                                                                                            <%= user.date_of_birth.toISOString().split('T')[0] %>
                                                                                                         <% } %>>
                                      <div class="date-empty-warning bg-danger text-white p-2 mt-0 rounded-3 d-none">Please Do Not Let It Empty</div>
                                </label>
                                
                                <h4 class="fw-bold pt-1">
                                <% if (user.date_of_birth != null) { %>
                                        <%= user.date_of_birth.getDate() + "-" + (user.date_of_birth.getMonth()+1) + "-" + user.date_of_birth.getFullYear() %>
                                <% } else { %>
                                        -
                                <% } %>
                                </h4>
                           
                            </div>
                            <!-- <div>
                                <label for = "select-country"> Country <br> 
                                </label> 
                                <select id = "select-country">
                                    <option value = "Malaysia"> Malaysia </option>
                                    <option value = "Singapore"> Singapore </option>
                                    <option value = "Thailand"> Thailand </option>
                                </select>
                            </div> -->
                        </div>  
                          <div class = "row pt-2">
                            <label for = "email" class="text-grey">Email<br> 
                              
                            </label>
                              <!-- <input type = "email" id = "email" name = "email"> -->
                             <h4 class="fw-bold pt-1" id="email"><%= user.email %></h4>
                        </div>                          
                        <!-- <div class = "row">
                            <div>
                                <label for = "state"> State <br>
                                    <input type = "text" id ="state" name = "state">
                                </label>
                            </div>
                            <div>
                                <label for = "city"> City <br>
                                    <input type = "text" id ="city" name = "city">
                                </label>
                            </div>
                        </div> -->
                        <br>
                        <!-- <div class = "btn-update-container"> 
                            <button type = "button" class = "btn btn-primary" id = "btn-update"> 
                                <img src = "Assests/img/save.jpg" alt = "save icon" id = "save-icon">
                                Update Profile Details </button>
                        </div> -->
                        <div class = "btn-update-container"> 
                            <button type = "button" class = "btn btn-primary" id = "btn-edit"> 
                            Edit Profile Details 
                            </button>
                            <button type = "button" class = "btn btn-primary d-none" id = "btn-save"> 
                            Save Profile Details 
                            </button>
                        </div>
                    </form>

                    <!-- <div class=""><%= user._id%></div> -->
                    
                    </div>
                  

                    <div class="col-xxl-5 col-xl-5 col-lg-5 ol-md-12 col-sm-12">

                        <form action = "/upload-image" method = "post" class = "profile-pic-form" id="profile_photo_form" enctype="multipart/form-data">
                            <h4 class = "form-title"> Profile Picture </h4>
                            <div class = "profile-pic-container">
                               <% if(user.image.data != null ) {%>
                                    <img src = "data:images/<%=user.image.contentType%>;base64,<%=user.image.data.toString('base64')%>" alt = "profile pic" id = "profile-pic" >
                                <% }else{ %>
                                    <img src = "./Assests/img/randomProfile.png" alt = "profile pic" id = "profile-pic">
                                <% } %>
                                <label for = "pic-file" class="mt-3">
                                    <input type = "file" id = "pic-file" name = "image">
                                    <div class="file-empty-warning bg-danger text-white p-2 mt-0 rounded-3 d-none">Please Select File</div>
                                </label>
                                <button type = "submit" class = "btn btn-primary" id = "btn-upload-image">
                                    <img src = "Assests/img/upload.png" alt = "upload icon" id = "upload-icon">
                                    Upload Photo
                                </button>
                            </div>
                        </form>

                        <!-- <form action = "#" method = "put" class = "delete-form text-center ">
                        <h4 class = "form-title" id = "delete-acc"> 
                            <img src = "Assests/img/warning.png" alt = "warning icon" id = "warning-icon"> 
                            Delete Account </h4>
                        <div class = "del-profile-container text-center">
                            <h5 class="p-0"> Deleting account will do 
                                the following: </h5>
                                <ul class="p-0"> 
                                    <li> Log out your account on all of your devices </li>
                                    <li> Permanently delete all data of this account </li>
                                </ul>
                        </div>
                        <div class = "btn-delete-container"> 
                        <button type = "button" class = "btn btn-delete" id = "delete_btn">
                            <img src = "Assests/img/delete.png" alt = "delete icon" id = "delete-icon">
                            Delete Account
                        </button>
                        </div>
                        </form> -->

                    </div>

                    <!-- <div id="modal-overlay">
                        <div id="modal">
                            <h2 id = "profile-name"> Random Username</h2>
                            <h4> Are you sure you want to delete your account? <br></h4>
                            <p>Deleting account will do the following:<br>
                                <ul>
                                    <li>Log out your account on all of your devices</li>
                                    <li>Permanently delete all data of this account</li>
                                </ul>
                            </p>
                            <button id = "dlt-btn"> Delete Account</button>
                            <button id="cancel-btn"> Cancel </button>
                        </div>
                    </div> -->
                </div>
                </div>
                </main>
        </section>

    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src = "Assests/JS/ckc.js"> </script>
    <!-- <script>
        function uploadImage(){
            event.preventDefault();
            const form = event.target;
            const form_data = new FormData(form);
            const ajax = new XMLHttpRequest();
            ajax.open("POST","/uploadImage",true)
            ajax.onreadystatechange = function(){
                
            }
        }
    </script> -->
    
</body>

</html>